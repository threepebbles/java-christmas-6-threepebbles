# 🎄 "크리스마스 프로모션" 프로젝트

목표: "12월 이벤트 플래너" 만들기

# 🚀 기획 요구사항

## 이벤트 진행 대상인 메뉴

```
<애피타이저>
양송이수프(6,000), 타파스(5,500), 시저샐러드(8,000)

<메인>
티본스테이크(55,000), 바비큐립(54,000), 해산물파스타(35,000), 크리스마스파스타(25,000)

<디저트>
초코케이크(15,000), 아이스크림(5,000)

<음료>
제로콜라(3,000), 레드와인(60,000), 샴페인(25,000)
```

## 할인 이벤트

- [x] 크리스마스 디데이 할인
    - 이벤트 기간: 2023.12.1 ~ 2023.12.25
    - 1,000원으로 시작하여 크리스마스가 다가올수록 날마다 할인 금액이 100원씩 증가
    - 총주문 금액에서 해당 금액만큼 할인  
      (e.g. 시작일인 12월 1일에 1,000원, 2일에 1,100원, ..., 25일엔 3,400원 할인)
- [x] 평일 할인(일요일~목요일): 평일에는 디저트 메뉴를 메뉴 1개당 2,023원 할인
- [x] 주말 할인(금요일, 토요일): 주말에는 메인 메뉴를 메뉴 1개당 2,023원 할인
- [x] 특별 할인: 이벤트 달력에 별이 있으면 총주문 금액에서 1,000원 할인
    - 별이 있는 날: 3, 10, 17, 24, 25, 31일

## 증정 이벤트

- [x] 할인 전 총주문 금액이 12만 원 이상일 때, 샴페인 1개 증정

## 배지 부여 이벤트

- [x] 혜택 금액에 따라 12월 이벤트 배지 부여
    - 총혜택 금액에 따라 다른 이벤트 배지를 부여합니다. 배지에 따라 새해 이벤트 참여 시, 각각 다른 새해 선물을 증정할 예정입니다.
        - 5천 원 이상: 별
        - 1만 원 이상: 트리
        - 2만 원 이상: 산타

## 이벤트 진행 기간

- 기간: 2023년 12월 1일(금) ~ 2023년 12월 31일(일)
- 특이사항: '크리스마스 디데이 할인'을 제외한 다른 이벤트는 2023.12.1 ~ 2023.12.31 동안 적용

## 이벤트 적용에 대한 주의 사항

- [x] 총주문 금액 10,000원 이상부터 이벤트가 적용됩니다.
- [x] 음료만 주문 시, 주문할 수 없습니다.
- [x] 메뉴는 한 번에 최대 20개까지만 주문할 수 있습니다.  
  (e.g. 시저샐러드-1, 티본스테이크-1, 크리스마스파스타-1, 제로콜라-3, 아이스크림-1의 총개수는 7개)

## '12월 이벤트 플래너' 개발 요청 사항

- [x] 고객들이 식당에 방문할 날짜와 메뉴를 미리 선택하면 이벤트 플래너가 주문 메뉴, 할인 전 총주문 금액, 증정 메뉴, 혜택 내역, 총혜택 금액, 할인 후 예상 결제 금액, 12월 이벤트 배지 내용을
  보여주기를
  기대합니다.
- [x] 12월 중 식당 예상 방문 날짜는 언제인가요? (숫자만 입력해 주세요!)
    - [x] 방문할 날짜는 1 이상 31 이하의 숫자로만 입력받아 주세요.
    - [x] 1 이상 31 이하의 숫자가 아닌 경우, "[ERROR] 유효하지 않은 날짜입니다. 다시 입력해 주세요."라는 에러 메시지를 보여 주세요.
    - [x] 모든 에러 메시지는 "[ERROR]"로 시작하도록 작성해 주세요.
- [x] 주문하실 메뉴와 개수를 알려 주세요. (e.g. 해산물파스타-2,레드와인-1,초코케이크-1)
    - [x] 고객이 메뉴판에 없는 메뉴를 입력하는 경우, "[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요."라는 에러 메시지를 보여 주세요.
    - [x] 메뉴의 개수는 1 이상의 숫자만 입력되도록 해주세요. 이외의 입력값은 "[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요."라는 에러 메시지를 보여 주세요.
    - [x] 메뉴 형식이 예시와 다른 경우, "[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요."라는 에러 메시지를 보여 주세요.
    - [x] 중복 메뉴를 입력한 경우(e.g. 시저샐러드-1,시저샐러드-1), "[ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요."라는 에러 메시지를 보여 주세요.
    - [x] 모든 에러 메시지는 "[ERROR]"로 시작하도록 작성해 주세요.
- [x] 주문 메뉴의 출력 순서는 자유롭게 출력해 주세요.
- [x] 총혜택 금액에 따라 이벤트 배지의 이름을 다르게 보여 주세요.
- [x] 총혜택 금액 = 할인 금액의 합계 + 증정 메뉴의 가격
- [x] 할인 후 예상 결제 금액 = 할인 전 총주문 금액 - 할인 금액
- 증정 메뉴
    - [x] 증정 이벤트에 해당하지 않는 경우, 증정 메뉴 "없음"으로 보여 주세요.
- 혜택 내역
    - [x] 고객에게 적용된 이벤트 내역만 보여 주세요.
    - [x] 적용된 이벤트가 하나도 없다면 혜택 내역 "없음"으로 보여 주세요.
    - [x] 혜택 내역에 여러 개의 이벤트가 적용된 경우, 출력 순서는 자유롭게 출력해주세요.
- 이벤트 배지
    - [x] 이벤트 배지가 부여되지 않는 경우, "없음"으로 보여 주세요.

## 전체 입출력

* 예시1 (적용된 이벤트가 하나도 없는 경우)

```
안녕하세요! 우테코 식당 12월 이벤트 플래너입니다.
12월 중 식당 예상 방문 날짜는 언제인가요? (숫자만 입력해 주세요!)
26 
주문하실 메뉴를 메뉴와 개수를 알려 주세요. (e.g. 해산물파스타-2,레드와인-1,초코케이크-1)
타파스-1,제로콜라-1 
12월 26일에 우테코 식당에서 받을 이벤트 혜택 미리 보기!
 
<주문 메뉴>
타파스 1개
제로콜라 1개

<할인 전 총주문 금액>
8,500원
 
<증정 메뉴>
없음
 
<혜택 내역>
없음
 
<총혜택 금액>
0원
 
<할인 후 예상 결제 금액>
8,500원
 
<12월 이벤트 배지>
없음
```

* 예시2

```
안녕하세요! 우테코 식당 12월 이벤트 플래너입니다.
12월 중 식당 예상 방문 날짜는 언제인가요? (숫자만 입력해 주세요!)
3
주문하실 메뉴를 메뉴와 개수를 알려 주세요. (e.g. 해산물파스타-2,레드와인-1,초코케이크-1)
티본스테이크-1,바비큐립-1,초코케이크-2,제로콜라-1
12월 3일에 우테코 식당에서 받을 이벤트 혜택 미리 보기!
 
<주문 메뉴>
티본스테이크 1개
바비큐립 1개
초코케이크 2개
제로콜라 1개
 
<할인 전 총주문 금액>
142,000원
 
<증정 메뉴>
샴페인 1개
 
<혜택 내역>
크리스마스 디데이 할인: -1,200원
평일 할인: -4,046원
특별 할인: -1,000원
증정 이벤트: -25,000원
 
<총혜택 금액>
-31,246원
 
<할인 후 예상 결제 금액>
135,754원
 
<12월 이벤트 배지>
산타
```

# 🏋️‍♀️ 구현을 위한 기능 설계서

아래는 실제 구현을 위한 기능 설계서입니다.

패키지별로 기능 요구사항을 구현합니다.

## 🖼️ view

### input

#### InputValidator

사용자 입력에 대한 간단한 검증을 하는 역할

* 방문 날짜 입력 검증
    * [x] 공백이 입력되면 안 된다.
    * [x] 숫자여야 한다.


* 주문 목록 검증
    * [x] 각 주문 메뉴와 개수의 입력 포맷은 `{주문 메뉴}-{개수}`여야 한다.
    * [x] 각 주문 메뉴와 개수에 공백이 입력되면 안 된다.
    * [x] 개수는 정수여야 한다.

#### InputConverter

사용자 입력(String 타입)을 파싱해서 DTO 객체로 변환하는 역할

* [x] 방문 날짜 변환
    * String -> 날짜 DTO
* [x] 주문 목록 변환
    * String -> 주문 목록 DTO

#### InputView

입력 문구와 함께 사용자 입력을 받는 역할

* [x] 식당 예상 방문 날짜 입력 받기
    * [x] 입력 문구와 함께 식당 예상 방문 날짜를 입력 받는다.
        * 입력 문구 예시
            ```
            안녕하세요! 우테코 식당 12월 이벤트 플래너입니다.
            12월 중 식당 예상 방문 날짜는 언제인가요? (숫자만 입력해 주세요!)
            ```
    * [x] InputValidator를 이용하여 날짜 입력을 검증한다.
    * [x] InputConverter를 이용하여 날짜 입력을 날짜 DTO로 변환한다.
    * [x] 유효하지 않은 입력인 경우 에러 메세지 출력 후 재입력을 받는다.
        * 에러메세지 양식
            ```
            [ERROR] 유효하지 않은 날짜입니다. 다시 입력해 주세요.
            ```

* [x] 주문 목록 입력 받기
    * [x] 주문할 메뉴와 개수를 입력 받는다.
        * 입력 문구 예시
            ```
            주문하실 메뉴를 메뉴와 개수를 알려 주세요. (e.g. 해산물파스타-2,레드와인-1,초코케이크-1)
            ```
    * [x] 주문 메뉴와 개수는 `,`(콤마) 단위로 구분한다.
    * [x] InputValidator를 이용하여 검증한다.
    * [x] InputConverter를 이용하여 주문 목록 입력을 주문 목록 DTO로 변환한다.
    * [x] 유효하지 않은 입력인 경우 에러 메세지 출력 후 재입력을 받는다.
        * 에러메세지 양식
            ```
            [ERROR] 유효하지 않은 주문입니다. 다시 입력해 주세요.
            ```

### Output

#### OutputView

OutputPresenter를 이용하여 사용자에게 출력될 화면을 **업데이트**하거나 **출력**하는 역할

#### OutputViewFormat

업데이트 되지 않는 화면 템플릿 관리 역할

#### OutputPresenter

업데이트 될 화면 양식 생성 역할

중괄호 `{}` 사이는 업데이트 되는 영역, 그 이외의 영역은 업데이트 되지 않는 영역이다.

OutputPresenter는 중괄호 `{}` 사이의 양식을 생성한다. 나머지 영역은 OutputViewFormat이 알고 있다.

* [x] 날짜를 받아 날짜 출력 양식을 생성한다.
    * 예시
        ```
        {12월 3일}에 우테코 식당에서 받을 이벤트 혜택 미리 보기!
        ```
* [x] 주문 목록을 받아 주문 목록 출력 양식을 생성한다.
    * 예시
        ```
        <주문 목록>
        {티본스테이크 1개
        바비큐립 1개
        초코케이크 2개
        제로콜라 1개}
        ```
* [x] 할인 전 총주문 금액 출력 양식을 생성한다.
    * 예시
      ```
      <할인 전 총주문 금액>
      {142,000원}
      ```
* [x] 증정 메뉴 출력 양식을 생성한다.
    * 예시
      ```
      <증정 메뉴>
      {샴페인 1개}
      ```

* [x] 혜택 내역 출력 양식을 생성한다.
    * 예시
        ```
        <혜택 내역>
        {크리스마스 디데이 할인: -1,200원
        평일 할인: -4,046원
        특별 할인: -1,000원
        증정 이벤트: -25,000원}
        ```
* [x] 총혜택 금액 출력 양식을 생성한다.
    * 예시
        ```
        <총혜택 금액>
        {-31,246원}
        ```
* [x] 할인 후 예상 결제 금액 출력 양식을 생성한다.
    * 예시
        ```
        <할인 후 예상 결제 금액>
        {135,754원}
        ```
* [x] 이벤트 배지 출력 양식을 생성한다.
    * 예시
        ```
        <12월 이벤트 배지>
        {산타}
        ```

## 🌉 controller

* [x] 식당 방문 날짜를 입력 받도록 한다.
    * [x] InputView로부터 날짜 DTO를 받아 도메인 로직에서 사용하는 날짜 객체로 변환
    * [x] 올바르지 않은 값일 시, 에러메세지 출력 후 재입력을 받도록 한다.

* [x] 주문 목록을 입력 받도록 한다.
    * [x] InputView로부터 주문 목록 DTO를 받아 도메인 로직에서 사용하는 주문 목록 객체로 변환
    * [x] 올바르지 않은 값일 시, 에러메세지 출력 후 재입력을 받도록 한다.

* [x] 이벤트 기획자에게 이벤트 플랜을 세워달라고 요청한다.

* [x] 이벤트 플랜을 사용자에게 출력하도록 한다.

## 🧑 model(domain)

### 날짜(Date)

날짜 정보를 담고 있는 클래스

* 생성자 검증
    * [x] 2023년이어야 한다.
    * [x] 12월이어야 한다.

### 메뉴(Menu)

주문 가능한 메뉴의 정보를 담고 있는 역할

* [x] 메뉴 타입을 갖고 있다.
    * 에피타이저, 메인, 디저트, 음료
* [x] 메뉴의 이름을 갖고 있다.
    * 바비큐립, 해산물파스타, 아이스크림, 제로콜라, ...
* [x] 메뉴의 금액을 갖고 있다.
* [x] 메뉴 이름을 통해 알맞는 메뉴 객체를 반환하는 기능

### 증정 메뉴(Gift)

증정 이벤트로 증정되는 물건의 정보를 담고 있는 역할

### 이벤트 배지(EventBadge)

이벤트 배지 종류에 대한 정보를 담고 있는 역할

* [x] 총혜택 금액에 따라 알맞는 이벤트 배지 객체를 반환하는 기능

### 주문(Order)

하나의 메뉴에 대한 주문을 담고 있는 역할

* [x] 주문한 한 메뉴와 개수 정보를 갖고 있다. (e.g. 해산물파스타 3개)
* 생성자 검증
    * [x] 주문한 메뉴는 존재하는 메뉴여야 한다.
    * [x] 주문 개수는 양수여야 한다.

### 주문 목록(Orders)

주문 목록 전체 정보를 담고 있는 역할

* 생성자 검증
    * [x] 중복된 메뉴가 있으면 안 된다.
    * [x] 음료만 주문하면 안 된다.
    * [x] 주문 개수의 총합은 20이하여야 한다.

* [x] 주문 목록은 이름순으로 정렬되어 있다. (테스트 편의 위해 정렬함)

### 각종 이벤트

#### 크리스마스 디데이 할인 이벤트

* [x] 날짜에 따라 할인가를 계산하는 기능
    * 12.1. ~ 12.25. 동안 진행
    * 12.1.엔 1000원 할인, 그 이후부터 할인액 100원씩 증가
    * 12.25. 이후엔 0원

#### 평일 할인 이벤트

* [x] 날짜에 따라 할인가를 계산하는 기능
    * 평일(금요일, 토요일 제외한 날)에 디저트 메뉴 하나당 2023원 할인

#### 주말 할인 이벤트

* [x] 날짜에 따라 할인가를 계산하는 기능
    * 주말(금요일, 토요일)에 메인 메뉴 하나당 2023원 할인

#### 특별 할인 이벤트

* [x] 날짜에 따라 할인가를 계산하는 기능
    * 별이 있는 날(3, 10, 17, 24, 25, 31일)에 1000원 할인

#### 증정 이벤트

* [x] 총주문 금액이 120000원 이상이면 샴페인 1개(25000원) 증정
* [x] 샴페인 무료 증정이므로 총혜택 금액에 25000원 추가

### 혜택 내역(DiscountResults)

* [x] 각 할인 이벤트 별로 얼마나 할인되었는지 정보를 갖고 있다.
    * [x] 크리스마스 디데이 이벤트로 할인된 금액
    * [x] 평일 할인 이벤트로 할인된 금액
    * [x] 주말 할인 이벤트로 할인된 금액
    * [x] 특별 할인 이벤트로 할인된 금액
    * [x] 증정 이벤트로 받은 물건의 금액
    * [x] 할인된 금액의 총합을 계산하는 기능
    * [x] 증정 이벤트를 제외한 할인 금액을 계산하는 기능
* [x] 할인된 금액이 0원인 것은 저장하지 않는다.

### 이벤트 계획(EventPlan)

이벤트 기획자에 의해 계산된 이벤트 계획. 아래의 정보들을 갖고 있다.

* [x] 방문 날짜 정보
* [x] 주문 목록 정보
* [x] 할인 전 총주문 금액
* [x] 증정 메뉴
* [x] 혜택 내역
* [x] 총혜택 금액
* [x] 할인 후 예쌍 결제 금액
* [x] 12월 이벤트 배지

## Service

### 이벤트 계획 서비스(EventPlanningService)

이벤트 계획을 세우는 비즈니스 로직을 수행하는 역할

* [x] 총주문 금액이 10000원 이상이면 이벤트 기획자를 이용하여 이벤트 계획을 세운다.
* [x] 총주문 금액이 10000원 미만이면 모든 이벤트를 적용하지 않는다.

### 이벤트 기획자(EventPlanner)

이벤트 계획을 세우는데 필요한 정보들을 계산해내는 역할

* [x] 할인 전 총주문 금액을 계산한다.
* [x] 증정 메뉴가 있는지 계산한다.
* [x] 혜택 내역을 계산한다.
    * [x] 할인 이벤트 중에 할인 금액이 0원인 것은 포함시키지 않는다.
* [x] 총혜택 금액을 계산한다.
    * [x] 총혜택 금액은 할인 전 총주문 금액을 넘을 수 없다.
* [x] 할인 후 예상 결제 금액을 계산한다.
    * [x] 할인 후 예상 결제 금액은 음수일 수 없다.
* [x] 12월 이벤트 배지를 계산한다.

## 입출력 흐름도

### 입력 흐름

<img src="./4주차 입력흐름도.drawio.png">

### 출력 흐름

<img src="./4주차 출력흐름도.drawio.png">